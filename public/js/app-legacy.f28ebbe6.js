(function(){var e={76495:function(e,t,n){"use strict";n(66992),n(88674),n(19601),n(17727);var a=n(70821),s=n(30968),r=n(30726),o=n(48731);"undefined"===typeof window.TextEncoder&&(window.TextEncoder=o.TextEncoder);var i=n(8958),c={id:"app"},u={class:"navbar bg-base-100"},l=(0,a._)("div",{class:"navbar-start"},[(0,a._)("a",{class:"btn btn-ghost normal-case text-xl"},[(0,a._)("img",{src:i,class:"w-32"})])],-1),d={class:"navbar-center hidden lg:flex"},g={class:"menu menu-horizontal p-0"},p={key:0},h=(0,a.Uk)(" Profile "),m={class:"navbar-end"},f={class:"ui text container",style:{"margin-top":"7em"}};function b(e,t,n,s,r,o){var i,b,v,w=(0,a.up)("router-link"),k=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("div",u,[l,(0,a._)("div",d,[(0,a._)("ul",g,[null!==(i=e.authState)&&void 0!==i&&i.isAuthenticated?((0,a.wg)(),(0,a.iD)("li",p,[(0,a.Wm)(w,{to:"/profile",class:"item",id:"profile-button"},{default:(0,a.w5)((function(){return[h]})),_:1})])):(0,a.kq)("",!0)])]),(0,a._)("div",m,[null!==(b=e.authState)&&void 0!==b&&b.isAuthenticated?((0,a.wg)(),(0,a.iD)("a",{key:0,class:"btn",onClick:t[0]||(t[0]=function(e){return o.logout()})},"Logout "+(0,a.zw)(e.claims),1)):(0,a.kq)("",!0),null!==(v=e.authState)&&void 0!==v&&v.isAuthenticated?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("a",{key:1,class:"btn",onClick:t[1]||(t[1]=function(e){return o.login()})},"Login"))])]),(0,a._)("div",f,[(0,a.Wm)(k)])])}var v=n(48534),w=(n(35666),{name:"app",data:function(){return{claims:""}},mounted:function(){this.setup()},methods:{setup:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("as ",e.authState),null===(n=e.authState)||void 0===n||!n.isAuthenticated){t.next=5;break}return t.next=4,e.$auth.getUser();case 4:e.claims=t.sent;case 5:case"end":return t.stop()}}),t)})))()},login:function(){this.$auth.signInWithRedirect({originalUri:"/"})},logout:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$auth.signOut();case 2:case"end":return t.stop()}}),t)})))()}}}),k=n(83744);const _=(0,k.Z)(w,[["render",b]]);var y=_,x=n(42119),D=(n(68309),{id:"home"}),T={key:0,class:"card lg:card-side bg-base-100 shadow-xl"},C=(0,a._)("figure",null,[(0,a._)("img",{src:"https://www.nandos.co.uk/sites/default/files/M_CHIX_RangeCore2021%20%281%29_1.jpg",alt:"Peri lovers",class:"w-96"})],-1),R={class:"card-body"},S=(0,a._)("h2",{class:"card-title"},"Olá!",-1),E=(0,a._)("p",null,"Click here to enjoy our Peri Peri heaven.",-1),U={class:"card-actions justify-end"},O=(0,a._)("label",{for:"guest-modal",class:"btn modal-button btn btn-secondary"},"Guest access",-1),j={key:1,class:"card bg-base-100 shadow-xl"},q={class:"card-body"},A={class:"card-title"},P={class:"card-actions justify-end"},L=(0,a._)("p",{class:"mb-10"}," You have successfully authenticated against your Okta org, and have been redirected back to this application. You now have an ID token and access token in local storage. ",-1),I=(0,a._)("a",{class:"btn btn-link",href:"/profile"}," My profile ",-1),z=(0,a._)("input",{type:"checkbox",id:"guest-modal",class:"modal-toggle"},null,-1),G={class:"modal"},Z={class:"modal-box relative"},M=(0,a._)("label",{for:"guest-modal",class:"btn btn-sm btn-circle absolute right-2 top-2"},"✕",-1),N={key:0},W=(0,a._)("h3",{class:"text-lg font-bold text-center"},"Welcome back!",-1),$={class:"w-full py-4 text-center"},V=(0,a._)("div",{class:"mb-5 mt-3"},[(0,a._)("img",{src:"https://media.giphy.com/media/3oxQNp0SiNeaYQ51Vm/giphy.gif",class:"mb-5 w-48 text-center m-auto"}),(0,a._)("strong",null,"We noticed you have already an account with us."),(0,a._)("br"),(0,a._)("br"),(0,a.Uk)("Why don't you log in as a customer to enjoy "),(0,a._)("a",{href:"javascript:void(0);"},"all these perks")],-1),Y={class:"mb-5"},H={key:1},J=(0,a._)("h3",{class:"text-lg font-bold"},"We just need a bit from you...",-1),Q={class:"w-full py-4"},B={class:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"},F={class:"mb-4"},K=(0,a._)("div",{class:"mt-3 mb-6"},[(0,a._)("label",{class:"block text-gray-500 font-bold"},[(0,a._)("input",{class:"mr-2 leading-tight",type:"checkbox"}),(0,a._)("span",{class:"text-sm"}," Sign me up to Nando’s emails for access to exclusive events and Extra Hot competitions! ")])],-1),X={class:"text-center mt-3"};function ee(e,t,n,s,r,o){var i,c;return(0,a.wg)(),(0,a.iD)("div",D,[null!==(i=e.authState)&&void 0!==i&&i.isAuthenticated?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",T,[C,(0,a._)("div",R,[S,E,(0,a._)("div",U,[(0,a._)("button",{id:"login-button",class:"btn btn-primary",role:"button",onClick:t[0]||(t[0]=function(e){return o.login()})}," Customer Login "),O])])])),null!==(c=e.authState)&&void 0!==c&&c.isAuthenticated?((0,a.wg)(),(0,a.iD)("div",j,[(0,a._)("div",q,[(0,a._)("h2",A,"Olá, "+(0,a.zw)(e.claims&&e.claims.name)+"!",1),(0,a._)("div",P,[L,I,(0,a._)("button",{id:"login-button",class:"btn btn-link",role:"button",onClick:t[1]||(t[1]=function(e){return o.logout()})}," Logout ")])])])):(0,a.kq)("",!0),z,(0,a._)("div",G,[(0,a._)("div",Z,[M,e.guestData.guest.existingRegisteredUser?((0,a.wg)(),(0,a.iD)("div",N,[W,(0,a._)("div",$,[V,(0,a._)("p",Y,[(0,a._)("button",{id:"login-button",class:"btn btn-primary",role:"button",onClick:t[2]||(t[2]=function(e){return o.login()})}," Login here ")]),(0,a._)("p",null,[(0,a._)("a",{onClick:t[3]||(t[3]=function(t){return o.loginGuest(e.guestData.guest.session)}),href:"javascript:void(0);"},"[Continue as guest]")])])])):(0,a.kq)("",!0),e.guestData.guest.session?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",H,[J,(0,a._)("div",Q,[(0,a._)("form",B,[(0,a._)("div",F,[(0,a.wy)((0,a._)("input",{class:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.guestEmail=t}),type:"text",placeholder:"email"},null,512),[[a.nr,e.guestEmail]]),K,(0,a._)("div",X,[(0,a._)("span",{class:(0,a.C_)("btn btn-secondary ".concat(e.guestLoading?"opacity-50 cursor-not-allowed":"")),role:"button",onClick:t[5]||(t[5]=function(e){return o.access()})}," Continue ",2)])])])])]))])])])}n(38862);var te=n(9669),ne=n.n(te),ae={name:"home",data:function(){return{claims:"",guestEmail:"",guestLoading:!1,guestData:{guest:{existingGuest:null,session:null},authorizeUrl:null}}},created:function(){this.setup()},methods:{setup:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null===(n=e.authState)||void 0===n||!n.isAuthenticated){t.next=4;break}return t.next=3,e.$auth.getUser();case 3:e.claims=t.sent;case 4:case"end":return t.stop()}}),t)})))()},logout:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$auth.signOut();case 2:case"end":return t.stop()}}),t)})))()},access:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.guestEmail){t.next=3;break}return alert("Please write an email"),t.abrupt("return");case 3:return e.guestLoading=!0,t.prev=4,t.next=7,ne()({method:"post",url:"".concat("https://nandos-okta-guest-checkout-ejkuwlr3ia-ez.a.run.app","/api/guest/new"),headers:{"Content-Type":"application/json"},data:JSON.stringify({email:e.guestEmail})});case 7:n=t.sent,console.log("guestResponse: ",n.data),e.guestData=n.data,!e.guestData.guest.existingRegisteredUser&&e.guestData.guest.session&&(console.log("Redirecting you are not guest..."),e.loginGuest(e.guestData.guest.session)),e.guestLoading=!1,t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](4),console.error(t.t0),alert("There is an error ".concat(JSON.stringify(t.t0))),e.guestLoading=!1;case 19:case"end":return t.stop()}}),t,null,[[4,14]])})))()},login:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$auth.revokeAccessToken();case 2:e.$auth.signInWithRedirect({originalUri:"/",loginHint:e.guestEmail});case 3:case"end":return t.stop()}}),t)})))()},loginGuest:function(e){this.$auth.signInWithRedirect({originalUri:"/",sessionToken:e})}}};const se=(0,k.Z)(ae,[["render",ee]]);var re=se,oe={class:"profile"},ie={class:"ui header"},ce={key:0,class:"badge badge-secondary"},ue={key:1,class:"badge badge-primary"},le=(0,a.Uk)(" My User Profile "),de=(0,a._)("hr",{class:"mb-10"},null,-1),ge={key:0,class:"mb-5"},pe=(0,a.Uk)(" Want to enjoy all Nando's features? "),he=(0,a._)("label",{for:"promote-modal",class:"modal-button text-emerald-700"},"Click here to create an account",-1),me=[pe,he],fe={class:"tabs tabs-boxed"},be={key:1,class:"tabContent mt-5"},ve={class:"text-sm whitespace-nowrap overflow-x-auto"},we={key:2,class:"tabContent mt-5"},ke={class:"text-sm whitespace-nowrap overflow-x-auto"},_e={key:3,class:"tabContent mt-5"},ye={class:"text-sm whitespace-nowrap overflow-x-auto"},xe={class:"ui table"},De=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Claim"),(0,a._)("th",null,"Value")])],-1),Te=["id"],Ce=(0,a._)("input",{type:"checkbox",id:"promote-modal",class:"modal-toggle"},null,-1),Re={class:"modal"},Se={class:"modal-box relative"},Ee=(0,a._)("label",{for:"promote-modal",class:"btn btn-sm btn-circle absolute right-2 top-2"},"✕",-1),Ue=(0,a._)("h3",null,"Choose a password!",-1),Oe={class:"mb-5"},je={class:"mb-5"},qe={class:"mt-3"},Ae={key:0,class:"text-red-500"},Pe={class:"text-center mt-3"};function Le(e,t,n,s,r,o){return(0,a.wg)(),(0,a.iD)("div",oe,[(0,a._)("h1",ie,[r.isGuest?((0,a.wg)(),(0,a.iD)("span",ce,"GUEST")):(0,a.kq)("",!0),r.isGuest?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("span",ue,"REGISTERED")),le]),de,r.isGuest?((0,a.wg)(),(0,a.iD)("p",ge,me)):(0,a.kq)("",!0),(0,a._)("div",fe,[(0,a._)("a",{class:(0,a.C_)("tab ".concat("tab1"==r.tab?"tab-active":"")),onClick:t[0]||(t[0]=function(e){return o.changeTab("tab1")})},"ID Token",2),(0,a._)("a",{class:(0,a.C_)("tab ".concat("tab2"==r.tab?"tab-active":"")),onClick:t[1]||(t[1]=function(e){return o.changeTab("tab2")})},"Access Token",2),(0,a._)("a",{class:(0,a.C_)("tab ".concat("tab3"==r.tab?"tab-active":"")),onClick:t[2]||(t[2]=function(e){return o.changeTab("tab3")})},"Claims",2)]),"tab1"===r.tab?((0,a.wg)(),(0,a.iD)("div",be,[(0,a._)("div",ve,[(0,a._)("pre",null,(0,a.zw)(r.idToken),1)])])):(0,a.kq)("",!0),"tab2"===r.tab?((0,a.wg)(),(0,a.iD)("div",we,[(0,a._)("div",ke,[(0,a._)("pre",null,(0,a.zw)(r.accessToken),1)])])):(0,a.kq)("",!0),"tab3"===r.tab?((0,a.wg)(),(0,a.iD)("div",_e,[(0,a._)("div",ye,[(0,a._)("table",xe,[De,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.claims,(function(e,t){return(0,a.wg)(),(0,a.iD)("tr",{key:t},[(0,a._)("td",null,(0,a.zw)(e.claim),1),(0,a._)("td",{id:"claim-"+e.claim},(0,a.zw)(e.value),9,Te)])})),128))])])])])):(0,a.kq)("",!0),Ce,(0,a._)("div",Re,[(0,a._)("div",Se,[Ee,Ue,(0,a._)("div",Oe,[(0,a.wy)((0,a._)("input",{class:"mt-3 shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"password","onUpdate:modelValue":t[3]||(t[3]=function(e){return r.password=e}),type:"password",placeholder:"password"},null,512),[[a.nr,r.password]])]),(0,a._)("div",je,[(0,a.wy)((0,a._)("input",{class:"mb-5shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"repeatPassword","onUpdate:modelValue":t[4]||(t[4]=function(e){return r.repeatPassword=e}),type:"password",placeholder:"Repeat password"},null,512),[[a.nr,r.repeatPassword]])]),(0,a._)("div",qe,[r.password!==r.repeatPassword?((0,a.wg)(),(0,a.iD)("p",Ae," Passwords are not the same ")):(0,a.kq)("",!0)]),(0,a._)("div",Pe,[(0,a._)("span",{class:(0,a.C_)("btn btn-secondary ".concat(r.guestLoading?"opacity-50 cursor-not-allowed":"")),role:"button",onClick:t[5]||(t[5]=function(e){return o.promoteAccount()})}," Create Account ",2)])])])])}n(21249),n(69720),n(65465),n(41539);var Ie={name:"Profile",data:function(){return{claims:[],accessToken:null,idToken:null,tab:"tab1",isGuest:null,password:null,repeatPassword:null,guestLoading:!1}},methods:{changeTab:function(e){this.tab=e},promoteAccount:function(){var e=this;this.guestLoading=!0,setTimeout((function(){e.guestLoading=!1,alert("Account created, redirecting you back to this screen in a few secs... We just created a real account (or update an existing one with the new password) and perform authN...")}),3e3)}},computed:{},created:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){var n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$auth.tokenManager.get("idToken");case 2:return n=t.sent,t.next=5,e.$auth.tokenManager.get("accessToken");case 5:return a=t.sent,e.idToken=n,e.accessToken=a,t.next=10,Object.entries(n.claims).map((function(e){return{claim:e[0],value:e[1]}}));case 10:e.claims=t.sent,s=e.claims.find((function(e){return"customer_type"===e.claim})),e.isGuest="guest"===s.value;case 13:case"end":return t.stop()}}),t)})))()}};const ze=(0,k.Z)(Ie,[["render",Le]]);var Ge=ze,Ze={class:"messages"},Me=(0,a._)("h1",{class:"ui header"},[(0,a._)("i",{"aria-hidden":"true",class:"mail outline icon"}),(0,a.Uk)(" My Messages ")],-1),Ne={key:0,class:"ui error message"},We=(0,a.uE)('<div class="content"><div class="header">Failed to fetch messages. Please verify the following:</div><ul class="list"><li class="content">You&#39;ve downloaded one of our resource server examples, and it&#39;s running on port 8000.</li><li class="content">Your resource server example is using the same Okta authorization server (issuer) that you have configured this Vue application to use.</li></ul></div>',1),$e=[We],Ve={key:1},Ye=(0,a.uE)("<p>This component makes a GET request to the resource server example, which must be running at <code>localhost:8000/api/messages</code></p><p>It attaches your current access token in the <code>Authorization</code> header on the request, and the resource server will attempt to authenticate this access token. If the token is valid the server will return a list of messages. If the token is not valid or the resource server is incorrectly configured, you will see a 401 <code>Unauthorized response</code>.</p><p>This route is protected by Okta with the <code>requiresAuth: true</code> metadata in <code>router/index.js</code>. This ensures that this page cannot be accessed until you have authenticated and have an access token in local storage.</p>",3),He={class:"ui table"},Je=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Date"),(0,a._)("th",null,"Message")])],-1),Qe=["id"];function Be(e,t,n,s,r,o){return(0,a.wg)(),(0,a.iD)("div",Ze,[Me,r.failed?((0,a.wg)(),(0,a.iD)("div",Ne,$e)):(0,a.kq)("",!0),r.messages.length?((0,a.wg)(),(0,a.iD)("div",Ve,[Ye,(0,a._)("table",He,[Je,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.messages,(function(e,t){return(0,a.wg)(),(0,a.iD)("tr",{key:t,id:"message-"+t},[(0,a._)("td",null,(0,a.zw)(e.date),1),(0,a._)("td",null,(0,a.zw)(e.text),1)],8,Qe)})),128))])])])):(0,a.kq)("",!0)])}n(92222);var Fe={NODE_ENV:"production",BASE_URL:"/",ISSUER:"https://dev-38486327.okta.com/oauth2/aus1hdmcqq7XJ1sP35d7",CLIENT_ID:"nandos-id-web-apps-dev",API_URL:"https://nandos-okta-guest-checkout-ejkuwlr3ia-ez.a.run.app"},Ke=Fe.CLIENT_ID,Xe=Fe.ISSUER,et={oidc:{clientId:Ke,issuer:Xe,redirectUri:window.location.origin+"/login/callback",scopes:["openid","profile","email"]},resourceServer:{messagesUrl:"http://localhost:8000/api/messages"}},tt={name:"Messages",data:function(){return{failed:!1,messages:[]}},created:function(){var e=this;return(0,v.Z)(regeneratorRuntime.mark((function t(){var n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=e.$auth.getAccessToken(),t.next=4,ne().get(et.resourceServer.messagesUrl,{headers:{Authorization:"Bearer ".concat(n)}});case 4:a=t.sent,s=a.data.messages.map((function(e){var t=1,n=new Date(e.date),a=n.toLocaleDateString(),s=n.toLocaleTimeString();return{date:"".concat(a," ").concat(s),text:e.text,index:t++}})),e.messages=s,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),console.error(t.t0),e.failed=!0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()}};const nt=(0,k.Z)(tt,[["render",Be]]);var at=nt,st=(0,x.p7)({history:(0,x.PO)("/"),routes:[{path:"/",component:re},{path:"/login/callback",component:r.kI},{path:"/profile",component:Ge,meta:{requiresAuth:!0}},{path:"/messages",component:at,meta:{requiresAuth:!0}}]});st.beforeEach(r.Q4);var rt=st,ot=new s.sn(et.oidc);(0,a.ri)(y).use(rt).use(r.ZP,{oktaAuth:ot}).mount("#app")},8958:function(e,t,n){"use strict";e.exports=n.p+"img/barci.006bf579.svg"},199:function(){}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,a,s,r){if(!a){var o=1/0;for(l=0;l<e.length;l++){a=e[l][0],s=e[l][1],r=e[l][2];for(var i=!0,c=0;c<a.length;c++)(!1&r||o>=r)&&Object.keys(n.O).every((function(e){return n.O[e](a[c])}))?a.splice(c--,1):(i=!1,r<o&&(o=r));if(i){e.splice(l--,1);var u=s();void 0!==u&&(t=u)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[a,s,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,r,o=a[0],i=a[1],c=a[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(c)var l=c(n)}for(t&&t(a);u<o.length;u++)r=o[u],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},a=self["webpackChunknandos_guest_checkout"]=self["webpackChunknandos_guest_checkout"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(76495)}));a=n.O(a)})();
//# sourceMappingURL=app-legacy.f28ebbe6.js.map