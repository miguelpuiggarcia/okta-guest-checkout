(function(){var e={9297:function(e,t,a){"use strict";var s=a(821),n=a(968),i=a(726),o=a(9555);"undefined"===typeof window.TextEncoder&&(window.TextEncoder=o.TextEncoder);var l=a(8958);const r={id:"app"},c={class:"navbar bg-base-100"},u=(0,s._)("div",{class:"navbar-start"},[(0,s._)("a",{class:"btn btn-ghost normal-case text-xl"},[(0,s._)("img",{src:l,class:"w-32"})])],-1),d={class:"navbar-center hidden lg:flex"},h={class:"menu menu-horizontal p-0"},g={key:0},p=(0,s.Uk)(" Profile "),b={class:"navbar-end"},m={class:"ui text container",style:{"margin-top":"7em"}};function v(e,t,a,n,i,o){const l=(0,s.up)("router-link"),v=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",c,[u,(0,s._)("div",d,[(0,s._)("ul",h,[e.authState?.isAuthenticated?((0,s.wg)(),(0,s.iD)("li",g,[(0,s.Wm)(l,{to:"/profile",class:"item",id:"profile-button"},{default:(0,s.w5)((()=>[p])),_:1})])):(0,s.kq)("",!0)])]),(0,s._)("div",b,[e.authState?.isAuthenticated?((0,s.wg)(),(0,s.iD)("a",{key:0,class:"btn",onClick:t[0]||(t[0]=e=>o.logout())},"Logout")):(0,s.kq)("",!0),e.authState?.isAuthenticated?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("a",{key:1,class:"btn",onClick:t[1]||(t[1]=e=>o.login())},"Login"))])]),(0,s._)("div",m,[(0,s.Wm)(v)])])}var f={name:"app",methods:{login(){this.$auth.signInWithRedirect({originalUri:"/"})},async logout(){await this.$auth.signOut()}}},_=a(3744);const k=(0,_.Z)(f,[["render",v]]);var w=k,y=a(7370);const x={id:"home"},D={key:0,class:"card lg:card-side bg-base-100 shadow-xl"},T=(0,s._)("figure",null,[(0,s._)("img",{src:"https://www.nandos.co.uk/sites/default/files/M_CHIX_RangeCore2021%20%281%29_1.jpg",alt:"Peri lovers",class:"w-96"})],-1),C={class:"card-body"},O=(0,s._)("h2",{class:"card-title"},"Olá!",-1),S=(0,s._)("p",null,"Click here to enjoy our Peri Peri heaven.",-1),j={class:"card-actions justify-end"},E=(0,s._)("label",{for:"guest-modal",class:"btn modal-button btn btn-secondary"},"Guest access",-1),q={key:1,class:"card bg-base-100 shadow-xl"},U={class:"card-body"},I={class:"card-title"},A={class:"card-actions justify-end"},L=(0,s._)("p",{class:"mb-10"}," You have successfully authenticated against your Okta org, and have been redirected back to this application. You now have an ID token and access token in local storage. ",-1),P=(0,s._)("a",{class:"btn btn-link",href:"/profile"}," My profile ",-1),z=(0,s._)("input",{type:"checkbox",id:"guest-modal",class:"modal-toggle"},null,-1),$={class:"modal"},M={class:"modal-box relative"},R=(0,s._)("label",{for:"guest-modal",class:"btn btn-sm btn-circle absolute right-2 top-2"},"✕",-1),N={key:0},W=(0,s._)("h3",{class:"text-lg font-bold text-center"},"Welcome back!",-1),G={class:"w-full py-4 text-center"},Y=(0,s._)("div",{class:"mb-5 mt-3"},[(0,s._)("img",{src:"https://media.giphy.com/media/3oxQNp0SiNeaYQ51Vm/giphy.gif",class:"mb-5 w-48 text-center m-auto"}),(0,s._)("strong",null,"We noticed you have already an account with us."),(0,s._)("br"),(0,s._)("br"),(0,s.Uk)("Why don't you log in as a customer to enjoy "),(0,s._)("a",{href:"javascript:void(0);"},"all these perks")],-1),V={class:"mb-5"},Z={key:1},H=(0,s._)("h3",{class:"text-lg font-bold"},"We just need a bit from you...",-1),J={class:"w-full py-4"},Q={class:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"},B={class:"mb-4"},F=(0,s._)("div",{class:"mt-3 mb-6"},[(0,s._)("label",{class:"block text-gray-500 font-bold"},[(0,s._)("input",{class:"mr-2 leading-tight",type:"checkbox"}),(0,s._)("span",{class:"text-sm"}," Sign me up to Nando’s emails for access to exclusive events and Extra Hot competitions! ")])],-1),K={class:"text-center mt-3"};function X(e,t,a,n,i,o){return(0,s.wg)(),(0,s.iD)("div",x,[e.authState?.isAuthenticated?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",D,[T,(0,s._)("div",C,[O,S,(0,s._)("div",j,[(0,s._)("button",{id:"login-button",class:"btn btn-primary",role:"button",onClick:t[0]||(t[0]=e=>o.login())}," Customer Login "),E])])])),e.authState?.isAuthenticated?((0,s.wg)(),(0,s.iD)("div",q,[(0,s._)("div",U,[(0,s._)("h2",I,"Olá, "+(0,s.zw)(e.claims&&e.claims.name)+"!",1),(0,s._)("div",A,[L,P,(0,s._)("button",{id:"login-button",class:"btn btn-link",role:"button",onClick:t[1]||(t[1]=e=>o.login())}," Logout ")])])])):(0,s.kq)("",!0),z,(0,s._)("div",$,[(0,s._)("div",M,[R,e.guestData.guest.existingGuest?((0,s.wg)(),(0,s.iD)("div",N,[W,(0,s._)("div",G,[Y,(0,s._)("p",V,[(0,s._)("button",{id:"login-button",class:"btn btn-primary",role:"button",onClick:t[2]||(t[2]=e=>o.login())}," Login here ")]),(0,s._)("p",null,[(0,s._)("a",{onClick:t[3]||(t[3]=t=>o.loginGuest(e.guestData.guest.session)),href:"javascript:void(0);"},"[Continue as guest]")])])])):(0,s.kq)("",!0),e.guestData.guest.session?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Z,[H,(0,s._)("div",J,[(0,s._)("form",Q,[(0,s._)("div",B,[(0,s.wy)((0,s._)("input",{class:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email","onUpdate:modelValue":t[4]||(t[4]=t=>e.guestEmail=t),type:"text",placeholder:"email"},null,512),[[s.nr,e.guestEmail]]),F,(0,s._)("div",K,[(0,s._)("span",{class:(0,s.C_)("btn btn-secondary "+(e.guestLoading?"opacity-50 cursor-not-allowed":"")),role:"button",onClick:t[5]||(t[5]=e=>o.access())}," Continue ",2)])])])])]))])])])}var ee=a(9669),te=a.n(ee),ae={name:"home",data:function(){return{claims:"",guestEmail:"",guestLoading:!1,guestData:{guest:{existingGuest:null,session:null},authorizeUrl:null}}},created(){this.setup()},methods:{async setup(){this.authState?.isAuthenticated&&(this.claims=await this.$auth.getUser())},async access(){if(""!==this.guestEmail){this.guestLoading=!0;try{const e=await te()({method:"post",url:"https://nandos-okta-guest-checkout-ejkuwlr3ia-ez.a.run.app//api/guest/new",headers:{"Content-Type":"application/json"},data:JSON.stringify({email:this.guestEmail})});console.log("guestResponse: ",e.data),this.guestData=e.data,!this.guestData.guest.existingGuest&&this.guestData.guest.session&&(console.log("Redirecting you are not customer..."),this.loginGuest(this.guestData.guest.session)),this.guestLoading=!1}catch(e){console.error(e),alert(`There is an error ${JSON.stringify(e)}`),this.guestLoading=!1}}else alert("Please write an email")},async login(){await this.$auth.revokeAccessToken(),this.$auth.signInWithRedirect({originalUri:"/"})},loginGuest(e){this.$auth.signInWithRedirect({originalUri:"/",sessionToken:e})}}};const se=(0,_.Z)(ae,[["render",X]]);var ne=se;const ie={class:"profile"},oe=(0,s._)("h1",{class:"ui header"},[(0,s._)("i",{"aria-hidden":"true",class:"drivers license icon"}),(0,s.Uk)(" My User Profile ")],-1),le={class:"tabs tabs-boxed"},re={key:0,class:"tabContent mt-5"},ce={class:"text-sm whitespace-nowrap overflow-x-auto"},ue={key:1,class:"tabContent mt-5"},de={class:"text-sm whitespace-nowrap overflow-x-auto"},he={key:2,class:"tabContent mt-5"},ge={class:"text-sm whitespace-nowrap overflow-x-auto"},pe={class:"ui table"},be=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Claim"),(0,s._)("th",null,"Value")])],-1),me=["id"];function ve(e,t,a,n,i,o){return(0,s.wg)(),(0,s.iD)("div",ie,[oe,(0,s._)("div",le,[(0,s._)("a",{class:(0,s.C_)("tab "+("tab1"==i.tab?"tab-active":"")),onClick:t[0]||(t[0]=e=>o.changeTab("tab1"))},"ID Token",2),(0,s._)("a",{class:(0,s.C_)("tab "+("tab2"==i.tab?"tab-active":"")),onClick:t[1]||(t[1]=e=>o.changeTab("tab2"))},"Access Token",2),(0,s._)("a",{class:(0,s.C_)("tab "+("tab3"==i.tab?"tab-active":"")),onClick:t[2]||(t[2]=e=>o.changeTab("tab3"))},"Claims",2)]),"tab1"===i.tab?((0,s.wg)(),(0,s.iD)("div",re,[(0,s._)("div",ce,[(0,s._)("pre",null,(0,s.zw)(i.idToken),1)])])):(0,s.kq)("",!0),"tab2"===i.tab?((0,s.wg)(),(0,s.iD)("div",ue,[(0,s._)("div",de,[(0,s._)("pre",null,(0,s.zw)(i.accessToken),1)])])):(0,s.kq)("",!0),"tab3"===i.tab?((0,s.wg)(),(0,s.iD)("div",he,[(0,s._)("div",ge,[(0,s._)("table",pe,[be,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.claims,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:t},[(0,s._)("td",null,(0,s.zw)(e.claim),1),(0,s._)("td",{id:"claim-"+e.claim},(0,s.zw)(e.value),9,me)])))),128))])])])])):(0,s.kq)("",!0)])}var fe={name:"Profile",data(){return{claims:[],accessToken:null,idToken:null,tab:"tab1"}},methods:{changeTab(e){this.tab=e}},async created(){const e=await this.$auth.tokenManager.get("idToken"),t=await this.$auth.tokenManager.get("accessToken");this.idToken=e,this.accessToken=t,this.claims=await Object.entries(e.claims).map((e=>({claim:e[0],value:e[1]})))}};const _e=(0,_.Z)(fe,[["render",ve]]);var ke=_e;const we={class:"messages"},ye=(0,s._)("h1",{class:"ui header"},[(0,s._)("i",{"aria-hidden":"true",class:"mail outline icon"}),(0,s.Uk)(" My Messages ")],-1),xe={key:0,class:"ui error message"},De=(0,s.uE)('<div class="content"><div class="header">Failed to fetch messages. Please verify the following:</div><ul class="list"><li class="content">You&#39;ve downloaded one of our resource server examples, and it&#39;s running on port 8000.</li><li class="content">Your resource server example is using the same Okta authorization server (issuer) that you have configured this Vue application to use.</li></ul></div>',1),Te=[De],Ce={key:1},Oe=(0,s.uE)("<p>This component makes a GET request to the resource server example, which must be running at <code>localhost:8000/api/messages</code></p><p>It attaches your current access token in the <code>Authorization</code> header on the request, and the resource server will attempt to authenticate this access token. If the token is valid the server will return a list of messages. If the token is not valid or the resource server is incorrectly configured, you will see a 401 <code>Unauthorized response</code>.</p><p>This route is protected by Okta with the <code>requiresAuth: true</code> metadata in <code>router/index.js</code>. This ensures that this page cannot be accessed until you have authenticated and have an access token in local storage.</p>",3),Se={class:"ui table"},je=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Date"),(0,s._)("th",null,"Message")])],-1),Ee=["id"];function qe(e,t,a,n,i,o){return(0,s.wg)(),(0,s.iD)("div",we,[ye,i.failed?((0,s.wg)(),(0,s.iD)("div",xe,Te)):(0,s.kq)("",!0),i.messages.length?((0,s.wg)(),(0,s.iD)("div",Ce,[Oe,(0,s._)("table",Se,[je,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.messages,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:t,id:"message-"+t},[(0,s._)("td",null,(0,s.zw)(e.date),1),(0,s._)("td",null,(0,s.zw)(e.text),1)],8,Ee)))),128))])])])):(0,s.kq)("",!0)])}const{CLIENT_ID:Ue,ISSUER:Ie}={NODE_ENV:"production",BASE_URL:"/",ISSUER:"https://dev-38486327.okta.com/oauth2/aus1hdmcqq7XJ1sP35d7",CLIENT_ID:"nandos-id-web-apps-dev",API_URL:"https://nandos-okta-guest-checkout-ejkuwlr3ia-ez.a.run.app/"};var Ae={oidc:{clientId:Ue,issuer:Ie,redirectUri:window.location.origin+"/login/callback",scopes:["openid","profile","email"]},resourceServer:{messagesUrl:"http://localhost:8000/api/messages"}},Le={name:"Messages",data(){return{failed:!1,messages:[]}},async created(){try{const e=this.$auth.getAccessToken(),t=await te().get(Ae.resourceServer.messagesUrl,{headers:{Authorization:`Bearer ${e}`}}),a=t.data.messages.map((e=>{let t=1;const a=new Date(e.date),s=a.toLocaleDateString(),n=a.toLocaleTimeString();return{date:`${s} ${n}`,text:e.text,index:t++}}));this.messages=a}catch(e){console.error(e),this.failed=!0}}};const Pe=(0,_.Z)(Le,[["render",qe]]);var ze=Pe;
/*!
 * Copyright (c) 2018-Present, Okta, Inc. and/or its affiliates. All rights reserved.
 * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the "License.")
 *
 * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *
 * See the License for the specific language governing permissions and limitations under the License.
 */
const $e=(0,y.p7)({history:(0,y.PO)("/"),routes:[{path:"/",component:ne},{path:"/login/callback",component:i.kI},{path:"/profile",component:ke,meta:{requiresAuth:!0}},{path:"/messages",component:ze,meta:{requiresAuth:!0}}]});$e.beforeEach(i.Q4);var Me=$e;
/*!
 * Copyright (c) 2018-Present, Okta, Inc. and/or its affiliates. All rights reserved.
 * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the "License.")
 *
 * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *
 * See the License for the specific language governing permissions and limitations under the License.
 */
const Re=new n.sn(Ae.oidc);(0,s.ri)(w).use(Me).use(i.ZP,{oktaAuth:Re}).mount("#app")},8958:function(e,t,a){"use strict";e.exports=a.p+"img/barci.006bf579.svg"},199:function(){}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,s,n,i){if(!s){var o=1/0;for(u=0;u<e.length;u++){s=e[u][0],n=e[u][1],i=e[u][2];for(var l=!0,r=0;r<s.length;r++)(!1&i||o>=i)&&Object.keys(a.O).every((function(e){return a.O[e](s[r])}))?s.splice(r--,1):(l=!1,i<o&&(o=i));if(l){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[s,n,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,i,o=s[0],l=s[1],r=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(r)var u=r(a)}for(t&&t(s);c<o.length;c++)i=o[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(u)},s=self["webpackChunknandos_guest_checkout"]=self["webpackChunknandos_guest_checkout"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(9297)}));s=a.O(s)})();
//# sourceMappingURL=app.520dd7f0.js.map