(function(){var e={6495:function(e,t,a){"use strict";var s=a(821),n=a(968),o=a(726),i=a(9555);"undefined"===typeof window.TextEncoder&&(window.TextEncoder=i.TextEncoder);var l=a(8958);const r={id:"app"},c={class:"navbar bg-base-100"},u=(0,s._)("div",{class:"navbar-start"},[(0,s._)("a",{class:"btn btn-ghost normal-case text-xl"},[(0,s._)("img",{src:l,class:"w-32"})])],-1),d={class:"navbar-center hidden lg:flex"},h={class:"menu menu-horizontal p-0"},g={key:0},p=(0,s.Uk)(" Profile "),m={class:"navbar-end"},b={class:"ui text container",style:{"margin-top":"7em"}};function w(e,t,a,n,o,i){const l=(0,s.up)("router-link"),w=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",c,[u,(0,s._)("div",d,[(0,s._)("ul",h,[e.authState?.isAuthenticated?((0,s.wg)(),(0,s.iD)("li",g,[(0,s.Wm)(l,{to:"/profile",class:"item",id:"profile-button"},{default:(0,s.w5)((()=>[p])),_:1})])):(0,s.kq)("",!0)])]),(0,s._)("div",m,[e.authState?.isAuthenticated?((0,s.wg)(),(0,s.iD)("a",{key:0,class:"btn",onClick:t[0]||(t[0]=e=>i.logout())},"Logout "+(0,s.zw)(e.claims),1)):(0,s.kq)("",!0),e.authState?.isAuthenticated?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("a",{key:1,class:"btn",onClick:t[1]||(t[1]=e=>i.login())},"Login"))])]),(0,s._)("div",b,[(0,s.Wm)(w)])])}var f={name:"app",data:function(){return{claims:""}},mounted(){this.setup()},methods:{async setup(){console.log("as ",this.authState),this.authState?.isAuthenticated&&(this.claims=await this.$auth.getUser())},login(){this.$auth.signInWithRedirect({originalUri:"/"})},async logout(){await this.$auth.signOut()}}},v=a(3744);const _=(0,v.Z)(f,[["render",w]]);var k=_,y=a(7370);const x={id:"home"},D={key:0,class:"card lg:card-side bg-base-100 shadow-xl"},T=(0,s._)("figure",null,[(0,s._)("img",{src:"https://www.nandos.co.uk/sites/default/files/M_CHIX_RangeCore2021%20%281%29_1.jpg",alt:"Peri lovers",class:"w-96"})],-1),C={class:"card-body"},S=(0,s._)("h2",{class:"card-title"},"Olá!",-1),E=(0,s._)("p",null,"Click here to enjoy our Peri Peri heaven.",-1),U={class:"card-actions justify-end"},O=(0,s._)("label",{for:"guest-modal",class:"btn modal-button btn btn-secondary"},"Guest access",-1),j={key:1,class:"card bg-base-100 shadow-xl"},q={class:"card-body"},A={class:"card-title"},P={class:"card-actions justify-end"},L=(0,s._)("p",{class:"mb-10"}," You have successfully authenticated against your Okta org, and have been redirected back to this application. You now have an ID token and access token in local storage. ",-1),I=(0,s._)("a",{class:"btn btn-link",href:"/profile"}," My profile ",-1),z=(0,s._)("input",{type:"checkbox",id:"guest-modal",class:"modal-toggle"},null,-1),R={class:"modal"},$={class:"modal-box relative"},G=(0,s._)("label",{for:"guest-modal",class:"btn btn-sm btn-circle absolute right-2 top-2"},"✕",-1),M={key:0},N=(0,s._)("h3",{class:"text-lg font-bold text-center"},"Welcome back!",-1),W={class:"w-full py-4 text-center"},V=(0,s._)("div",{class:"mb-5 mt-3"},[(0,s._)("img",{src:"https://media.giphy.com/media/3oxQNp0SiNeaYQ51Vm/giphy.gif",class:"mb-5 w-48 text-center m-auto"}),(0,s._)("strong",null,"We noticed you have already an account with us."),(0,s._)("br"),(0,s._)("br"),(0,s.Uk)("Why don't you log in as a customer to enjoy "),(0,s._)("a",{href:"javascript:void(0);"},"all these perks")],-1),Y={class:"mb-5"},H={key:1},Z=(0,s._)("h3",{class:"text-lg font-bold"},"We just need a bit from you...",-1),J={class:"w-full py-4"},Q={class:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"},B={class:"mb-4"},F=(0,s._)("div",{class:"mt-3 mb-6"},[(0,s._)("label",{class:"block text-gray-500 font-bold"},[(0,s._)("input",{class:"mr-2 leading-tight",type:"checkbox"}),(0,s._)("span",{class:"text-sm"}," Sign me up to Nando’s emails for access to exclusive events and Extra Hot competitions! ")])],-1),K={class:"text-center mt-3"};function X(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",x,[e.authState?.isAuthenticated?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",D,[T,(0,s._)("div",C,[S,E,(0,s._)("div",U,[(0,s._)("button",{id:"login-button",class:"btn btn-primary",role:"button",onClick:t[0]||(t[0]=e=>i.login())}," Customer Login "),O])])])),e.authState?.isAuthenticated?((0,s.wg)(),(0,s.iD)("div",j,[(0,s._)("div",q,[(0,s._)("h2",A,"Olá, "+(0,s.zw)(e.claims&&e.claims.name)+"!",1),(0,s._)("div",P,[L,I,(0,s._)("button",{id:"login-button",class:"btn btn-link",role:"button",onClick:t[1]||(t[1]=e=>i.logout())}," Logout ")])])])):(0,s.kq)("",!0),z,(0,s._)("div",R,[(0,s._)("div",$,[G,e.guestData.guest.existingRegisteredUser?((0,s.wg)(),(0,s.iD)("div",M,[N,(0,s._)("div",W,[V,(0,s._)("p",Y,[(0,s._)("button",{id:"login-button",class:"btn btn-primary",role:"button",onClick:t[2]||(t[2]=e=>i.login())}," Login here ")]),(0,s._)("p",null,[(0,s._)("a",{onClick:t[3]||(t[3]=t=>i.loginGuest(e.guestData.guest.session)),href:"javascript:void(0);"},"[Continue as guest]")])])])):(0,s.kq)("",!0),e.guestData.guest.session?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",H,[Z,(0,s._)("div",J,[(0,s._)("form",Q,[(0,s._)("div",B,[(0,s.wy)((0,s._)("input",{class:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email","onUpdate:modelValue":t[4]||(t[4]=t=>e.guestEmail=t),type:"text",placeholder:"email"},null,512),[[s.nr,e.guestEmail]]),F,(0,s._)("div",K,[(0,s._)("span",{class:(0,s.C_)("btn btn-secondary "+(e.guestLoading?"opacity-50 cursor-not-allowed":"")),role:"button",onClick:t[5]||(t[5]=e=>i.access())}," Continue ",2)])])])])]))])])])}var ee=a(9669),te=a.n(ee),ae={name:"home",data:function(){return{claims:"",guestEmail:"",guestLoading:!1,guestData:{guest:{existingGuest:null,session:null},authorizeUrl:null}}},created(){this.setup()},methods:{async setup(){this.authState?.isAuthenticated&&(this.claims=await this.$auth.getUser())},async logout(){await this.$auth.signOut()},async access(){if(""!==this.guestEmail){this.guestLoading=!0;try{const e=await te()({method:"post",url:"https://nandos-okta-guest-checkout-ejkuwlr3ia-ez.a.run.app/api/guest/new",headers:{"Content-Type":"application/json"},data:JSON.stringify({email:this.guestEmail})});console.log("guestResponse: ",e.data),this.guestData=e.data,!this.guestData.guest.existingRegisteredUser&&this.guestData.guest.session&&(console.log("Redirecting you are not guest..."),this.loginGuest(this.guestData.guest.session)),this.guestLoading=!1}catch(e){console.error(e),alert(`There is an error ${JSON.stringify(e)}`),this.guestLoading=!1}}else alert("Please write an email")},async login(){await this.$auth.revokeAccessToken(),this.$auth.signInWithRedirect({originalUri:"/",loginHint:this.guestEmail})},loginGuest(e){this.$auth.signInWithRedirect({originalUri:"/",sessionToken:e})}}};const se=(0,v.Z)(ae,[["render",X]]);var ne=se;const oe={class:"profile"},ie={class:"ui header"},le={key:0,class:"badge badge-secondary"},re={key:1,class:"badge badge-primary"},ce=(0,s.Uk)(" My User Profile "),ue=(0,s._)("hr",{class:"mb-10"},null,-1),de={key:0,class:"mb-5"},he=(0,s.Uk)(" Want to enjoy all Nando's features? "),ge=(0,s._)("label",{for:"promote-modal",class:"modal-button text-emerald-700"},"Click here to create an account",-1),pe=[he,ge],me={class:"tabs tabs-boxed"},be={key:1,class:"tabContent mt-5"},we={class:"text-sm whitespace-nowrap overflow-x-auto"},fe={key:2,class:"tabContent mt-5"},ve={class:"text-sm whitespace-nowrap overflow-x-auto"},_e={key:3,class:"tabContent mt-5"},ke={class:"text-sm whitespace-nowrap overflow-x-auto"},ye={class:"ui table"},xe=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Claim"),(0,s._)("th",null,"Value")])],-1),De=["id"],Te=(0,s._)("input",{type:"checkbox",id:"promote-modal",class:"modal-toggle"},null,-1),Ce={class:"modal"},Se={class:"modal-box relative"},Ee=(0,s._)("label",{for:"promote-modal",class:"btn btn-sm btn-circle absolute right-2 top-2"},"✕",-1),Ue=(0,s._)("h3",null,"Choose a password!",-1),Oe={class:"mb-5"},je={class:"mb-5"},qe={class:"mt-3"},Ae={key:0,class:"text-red-500"},Pe={class:"text-center mt-3"};function Le(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",oe,[(0,s._)("h1",ie,[o.isGuest?((0,s.wg)(),(0,s.iD)("span",le,"GUEST")):(0,s.kq)("",!0),o.isGuest?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("span",re,"REGISTERED")),ce]),ue,o.isGuest?((0,s.wg)(),(0,s.iD)("p",de,pe)):(0,s.kq)("",!0),(0,s._)("div",me,[(0,s._)("a",{class:(0,s.C_)("tab "+("tab1"==o.tab?"tab-active":"")),onClick:t[0]||(t[0]=e=>i.changeTab("tab1"))},"ID Token",2),(0,s._)("a",{class:(0,s.C_)("tab "+("tab2"==o.tab?"tab-active":"")),onClick:t[1]||(t[1]=e=>i.changeTab("tab2"))},"Access Token",2),(0,s._)("a",{class:(0,s.C_)("tab "+("tab3"==o.tab?"tab-active":"")),onClick:t[2]||(t[2]=e=>i.changeTab("tab3"))},"Claims",2)]),"tab1"===o.tab?((0,s.wg)(),(0,s.iD)("div",be,[(0,s._)("div",we,[(0,s._)("pre",null,(0,s.zw)(o.idToken),1)])])):(0,s.kq)("",!0),"tab2"===o.tab?((0,s.wg)(),(0,s.iD)("div",fe,[(0,s._)("div",ve,[(0,s._)("pre",null,(0,s.zw)(o.accessToken),1)])])):(0,s.kq)("",!0),"tab3"===o.tab?((0,s.wg)(),(0,s.iD)("div",_e,[(0,s._)("div",ke,[(0,s._)("table",ye,[xe,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.claims,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:t},[(0,s._)("td",null,(0,s.zw)(e.claim),1),(0,s._)("td",{id:"claim-"+e.claim},(0,s.zw)(e.value),9,De)])))),128))])])])])):(0,s.kq)("",!0),Te,(0,s._)("div",Ce,[(0,s._)("div",Se,[Ee,Ue,(0,s._)("div",Oe,[(0,s.wy)((0,s._)("input",{class:"mt-3 shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>o.password=e),type:"password",placeholder:"password"},null,512),[[s.nr,o.password]])]),(0,s._)("div",je,[(0,s.wy)((0,s._)("input",{class:"mb-5shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"repeatPassword","onUpdate:modelValue":t[4]||(t[4]=e=>o.repeatPassword=e),type:"password",placeholder:"Repeat password"},null,512),[[s.nr,o.repeatPassword]])]),(0,s._)("div",qe,[o.password!==o.repeatPassword?((0,s.wg)(),(0,s.iD)("p",Ae," Passwords are not the same ")):(0,s.kq)("",!0)]),(0,s._)("div",Pe,[(0,s._)("span",{class:(0,s.C_)("btn btn-secondary "+(o.guestLoading?"opacity-50 cursor-not-allowed":"")),role:"button",onClick:t[5]||(t[5]=e=>i.promoteAccount())}," Create Account ",2)])])])])}var Ie={name:"Profile",data(){return{claims:[],accessToken:null,idToken:null,tab:"tab1",isGuest:null,password:null,repeatPassword:null,guestLoading:!1}},methods:{changeTab(e){this.tab=e},promoteAccount(){this.guestLoading=!0,setTimeout((()=>{this.guestLoading=!1,alert("Account created, redirecting you back to this screen in a few secs... We just created a real account (or update an existing one with the new password) and perform authN...")}),3e3)}},computed:{},async created(){const e=await this.$auth.tokenManager.get("idToken"),t=await this.$auth.tokenManager.get("accessToken");this.idToken=e,this.accessToken=t,this.claims=await Object.entries(e.claims).map((e=>({claim:e[0],value:e[1]})));let a=this.claims.find((function(e){return"customer_type"===e.claim}));this.isGuest="guest"===a.value}};const ze=(0,v.Z)(Ie,[["render",Le]]);var Re=ze;const $e={class:"messages"},Ge=(0,s._)("h1",{class:"ui header"},[(0,s._)("i",{"aria-hidden":"true",class:"mail outline icon"}),(0,s.Uk)(" My Messages ")],-1),Me={key:0,class:"ui error message"},Ne=(0,s.uE)('<div class="content"><div class="header">Failed to fetch messages. Please verify the following:</div><ul class="list"><li class="content">You&#39;ve downloaded one of our resource server examples, and it&#39;s running on port 8000.</li><li class="content">Your resource server example is using the same Okta authorization server (issuer) that you have configured this Vue application to use.</li></ul></div>',1),We=[Ne],Ve={key:1},Ye=(0,s.uE)("<p>This component makes a GET request to the resource server example, which must be running at <code>localhost:8000/api/messages</code></p><p>It attaches your current access token in the <code>Authorization</code> header on the request, and the resource server will attempt to authenticate this access token. If the token is valid the server will return a list of messages. If the token is not valid or the resource server is incorrectly configured, you will see a 401 <code>Unauthorized response</code>.</p><p>This route is protected by Okta with the <code>requiresAuth: true</code> metadata in <code>router/index.js</code>. This ensures that this page cannot be accessed until you have authenticated and have an access token in local storage.</p>",3),He={class:"ui table"},Ze=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Date"),(0,s._)("th",null,"Message")])],-1),Je=["id"];function Qe(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",$e,[Ge,o.failed?((0,s.wg)(),(0,s.iD)("div",Me,We)):(0,s.kq)("",!0),o.messages.length?((0,s.wg)(),(0,s.iD)("div",Ve,[Ye,(0,s._)("table",He,[Ze,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.messages,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:t,id:"message-"+t},[(0,s._)("td",null,(0,s.zw)(e.date),1),(0,s._)("td",null,(0,s.zw)(e.text),1)],8,Je)))),128))])])])):(0,s.kq)("",!0)])}const{CLIENT_ID:Be,ISSUER:Fe}={NODE_ENV:"production",BASE_URL:"/",ISSUER:"https://dev-38486327.okta.com/oauth2/aus1hdmcqq7XJ1sP35d7",CLIENT_ID:"nandos-id-web-apps-dev",API_URL:"https://nandos-okta-guest-checkout-ejkuwlr3ia-ez.a.run.app"};var Ke={oidc:{clientId:Be,issuer:Fe,redirectUri:window.location.origin+"/login/callback",scopes:["openid","profile","email"]},resourceServer:{messagesUrl:"http://localhost:8000/api/messages"}},Xe={name:"Messages",data(){return{failed:!1,messages:[]}},async created(){try{const e=this.$auth.getAccessToken(),t=await te().get(Ke.resourceServer.messagesUrl,{headers:{Authorization:`Bearer ${e}`}}),a=t.data.messages.map((e=>{let t=1;const a=new Date(e.date),s=a.toLocaleDateString(),n=a.toLocaleTimeString();return{date:`${s} ${n}`,text:e.text,index:t++}}));this.messages=a}catch(e){console.error(e),this.failed=!0}}};const et=(0,v.Z)(Xe,[["render",Qe]]);var tt=et;
/*!
 * Copyright (c) 2018-Present, Okta, Inc. and/or its affiliates. All rights reserved.
 * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the "License.")
 *
 * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *
 * See the License for the specific language governing permissions and limitations under the License.
 */
const at=(0,y.p7)({history:(0,y.PO)("/"),routes:[{path:"/",component:ne},{path:"/login/callback",component:o.kI},{path:"/profile",component:Re,meta:{requiresAuth:!0}},{path:"/messages",component:tt,meta:{requiresAuth:!0}}]});at.beforeEach(o.Q4);var st=at;
/*!
 * Copyright (c) 2018-Present, Okta, Inc. and/or its affiliates. All rights reserved.
 * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the "License.")
 *
 * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *
 * See the License for the specific language governing permissions and limitations under the License.
 */
const nt=new n.sn(Ke.oidc);(0,s.ri)(k).use(st).use(o.ZP,{oktaAuth:nt}).mount("#app")},8958:function(e,t,a){"use strict";e.exports=a.p+"img/barci.006bf579.svg"},199:function(){}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,s,n,o){if(!s){var i=1/0;for(u=0;u<e.length;u++){s=e[u][0],n=e[u][1],o=e[u][2];for(var l=!0,r=0;r<s.length;r++)(!1&o||i>=o)&&Object.keys(a.O).every((function(e){return a.O[e](s[r])}))?s.splice(r--,1):(l=!1,o<i&&(i=o));if(l){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,n,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,o,i=s[0],l=s[1],r=s[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(r)var u=r(a)}for(t&&t(s);c<i.length;c++)o=i[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},s=self["webpackChunknandos_guest_checkout"]=self["webpackChunknandos_guest_checkout"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(6495)}));s=a.O(s)})();
//# sourceMappingURL=app.66fbc753.js.map